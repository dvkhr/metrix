package sign // import "github.com/dvkhr/metrix.git/internal/sign"


FUNCTIONS

func SignCheck(h http.HandlerFunc, signKey []byte) http.HandlerFunc
    SignCheck создает middleware для проверки подписи HTTP-запроса. Middleware
    проверяет подпись запроса с использованием ключа (signKey). Если ключ
    пустой, проверка пропускается, и запрос передается дальше.

    Логика работы:
     1. Если signKey пустой, запрос передается обработчику без проверки.
     2. Тело запроса считывается и сохраняется в буфер для последующего
        использования.
     3. Проверяется наличие заголовка "HashSHA256" в запросе. Если заголовок
        отсутствует или подпись недействительна, возвращается ошибка 400 (Bad
        Request).
     4. Если подпись действительна, запрос передается обработчику.

    Параметры: - h: Обработчик HTTP-запроса, который будет вызван после проверки
    подписи. - signKey: Ключ, используемый для проверки подписи.

    Возвращаемое значение: - http.HandlerFunc: Middleware, который выполняет
    проверку подписи.

